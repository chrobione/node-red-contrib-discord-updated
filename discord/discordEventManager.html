a<script type="text/javascript">
  RED.nodes.registerType('discordEventManager', {
    category: 'discord · guild control',
    color: '#7289da',
    defaults: {
      name: {
        value: "",
        required: false
      },
      guild: {
        value: null,
        required: false
      },
      event: {
        value: null,
        required: false
      },
      token: {
        value: "",
        required: true,
        type: "discord-token"
      }
    },
    inputs: 1,
    outputs: 1,
    icon: "discord.png",
    label: function () {
      return this.name || "discordEventManager";
    }
  });
</script>
<script type="text/x-red" data-template-name="discordEventManager">
  <div class="form-row">
        <label for="node-input-token"><i class="icon-tag"></i> token</label>
        <input type="text" id="node-input-token" placeholder="token">
    </div>
    <div class="form-row">
        <label for="node-input-guild"><i class="icon-tag"></i> Guild</label>
        <input type="text" id="node-input-guild" name="ch" placeholder="Guild ID">
        <p>(leave 'guild' blank to use <code>msg.guild</code> as Guild ID)</p>
    </div>
    <div class="form-row">
      <label for="node-input-event"><i class="icon-tag"></i> Event</label>
      <input type="text" id="node-input-event" name="ch" placeholder="Event ID">
      <p>(leave 'event' blank to use <code>msg.event</code> as Event ID)</p>
  </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
</script>
<script type="text/x-red" data-help-name="discordEventManager">
  <p><strong>What it does</strong> — Creates, updates, lists, or deletes Discord scheduled events for a guild.</p>
  <p><strong>When to use it</strong> — Automate event calendars, post reminders for community nights, or clean up old events.</p>

  <h3>Inputs</h3>
  <dl class="message-properties">
    <dt>action <span class="property-type">string</span></dt>
    <dd><code>create</code>, <code>info</code>, <code>all</code>, <code>update</code>, or <code>delete</code>. Defaults to <code>info</code>.</dd>
    <dt>guild <span class="property-type">object | string</span></dt>
    <dd>The guild id/object the event lives in.</dd>
    <dt>event <span class="property-type">object | string</span></dt>
    <dd>For <code>info</code>, <code>update</code>, or <code>delete</code>: the event object/id.</dd>
    <dt>eventName, eventDescription <span class="property-type">string</span></dt>
    <dd>Used when creating or updating events.</dd>
    <dt>eventScheduledStartTime / eventScheduledEndTime <span class="property-type">number | string</span></dt>
    <dd>JS date compatible values (ISO string or timestamp). End time required for external events.</dd>
    <dt>eventType <span class="property-type">string</span></dt>
    <dd><code>external</code>, <code>voice</code>, or <code>stage</code>.</dd>
    <dt>eventChannel <span class="property-type">string</span></dt>
    <dd>For voice/stage events: the channel id that hosts the event.</dd>
    <dt>eventLocation <span class="property-type">string</span></dt>
    <dd>For external events: free-form location text.</dd>
    <dt>reason <span class="property-type">string</span></dt>
    <dd>Optional audit-log reason.</dd>
  </dl>

  <h3>Output</h3>
  <dl class="message-properties">
    <dt>payload <span class="property-type">object | array</span></dt>
    <dd>The created/updated event, a specific event, or an array of events (for <code>all</code>).</dd>
  </dl>

  <h3>Tips</h3>
  <ul>
    <li>Use ISO date strings like <code>2024-12-31T20:00:00Z</code> to avoid timezone surprises.</li>
    <li>Send reminder messages by wiring the output into <code>discordMessageManager</code> and reading event start times.</li>
    <li>Bot needs <em>Manage Events</em> permissions to create or delete scheduled events.</li>
  </ul>
</script>
