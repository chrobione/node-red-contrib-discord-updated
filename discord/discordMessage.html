<script type="text/javascript">
  RED.nodes.registerType('discordMessage', {
    category: 'Discord · Event Intake',
    color: '#7289da',
    defaults: {
      name: {
        value: "",
        required: false
      },
      channelIdFilter: {
        value: "",
        required: false
      },
      token: {
        value: "",
        required: true,
        type: "discord-token"
      }
    },
    inputs: 0,
    outputs: 1,
    icon: "font-awesome/fa-comments",
    label: function () {
      return this.name || "Discord Message";
    }
  });
</script>
<script type="text/x-red" data-template-name="discordMessage">
  <div class="form-row">
        <label for="node-input-token"><i class="icon-tag"></i> token</label>
        <input type="text" id="node-input-token" placeholder="token">
    </div>
    <div class="form-row">
        <label for="node-input-name"><i class="icon-tag"></i> Name</label>
        <input type="text" id="node-input-name" placeholder="Name">
    </div>
    <div class="form-row">
        <label for="node-input-channelIdFilter"><i class="icon-tag"></i> Channel Filter</label>
        <input type="text" id="node-input-channelIdFilter" placeholder="Channel Id Filter">
    </div>
</script>
<script type="text/x-red" data-help-name="discordMessage">
  <p><strong>What it does</strong> — Listens for every message your bot can see in the selected servers and passes the details into your flow. Think of it as your Discord inbox inside Node-RED.</p>
  <p><strong>When to use it</strong> — Start here if you want to react to chat activity: auto-reply to keywords, log conversations, trigger automations when a moderator posts, and so on. Add a channel ID filter when you only care about one room.</p>

  <h3>Message output</h3>
  <dl class="message-properties">
      <dt>payload <span class="property-type">string</span></dt>
      <dd>The plain-text body of the Discord message.</dd>
      <dt>channel <span class="property-type">object</span></dt>
      <dd>Basic info about where the message arrived (id, name, type) so you can route replies.</dd>
      <dt>author <span class="property-type">object</span></dt>
      <dd>Details about who sent the message (id, username, discriminator, bot flag).</dd>
      <dt>memberRoleNames <span class="property-type">array</span></dt>
      <dd>Role names the author currently has in the guild (handy for permission checks).</dd>
      <dt>memberRoleIDs <span class="property-type">array</span></dt>
      <dd>The same roles as raw Discord snowflakes if you need to compare ids.</dd>
      <dt>data <span class="property-type">object</span></dt>
      <dd>The full message payload (without live discord.js functions) so advanced flows can dig deeper.</dd>
  </dl>

  <h3>Tips</h3>
  <ul>
    <li>Wire this node into a debug node first to see the structure that comes through before building logic.</li>
    <li>Combine it with a switch node to react only when <code>msg.payload</code> contains certain words.</li>
    <li>If your bot is in large servers, use the channel filter to avoid flooding your flow with extra traffic.</li>
  </ul>
</script>
